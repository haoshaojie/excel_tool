{"remainingRequest":"F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\node_modules\\babel-loader\\lib\\index.js!F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\src\\views\\contract\\product\\group\\itemInfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\src\\views\\contract\\product\\group\\itemInfo.vue","mtime":1618794737784},{"path":"F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _toConsumableArray from \"F:/\\u4E1C\\u65B9\\u901A/source/b_zwj/xinhua-finance-web/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport \"core-js/modules/es6.number.constructor\";\nimport \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport itemDialog from \"./item-dialog\";\nimport priceDialog from \"./price-dialog\";\nexport default {\n  name: 'product-info',\n  components: {\n    itemDialog: itemDialog,\n    priceDialog: priceDialog\n  },\n  props: {\n    isView: false,\n    itemInfo: {}\n  },\n  data: function data() {\n    return {\n      dialogForm: {},\n      dialogPriceForm: {\n        prodName: '',\n        prodType: '',\n        prodId: '',\n        type: ''\n      },\n      dialogOpen: {\n        prod: false,\n        price: false\n      }\n    };\n  },\n  mounted: function mounted() {\n    this.onLoad();\n  },\n  methods: {\n    onLoad: function onLoad() {},\n    arraySpanMethod: function arraySpanMethod() {\n      var that = this;\n      setTimeout(function () {\n        if (that.$el.querySelector(\".el-table__footer-wrapper\")) {\n          var current = that.$el.querySelector(\".el-table__footer-wrapper\").querySelector(\".el-table__footer\");\n          var cells = current.rows[0].cells;\n          cells[0].colSpan = \"7\";\n          cells[1].colSpan = \"4\";\n        }\n      }, 50);\n    },\n    getSummaries: function getSummaries(param) {\n      var columns = param.columns,\n          data = param.data;\n      var sums = [];\n      columns.forEach(function (column, index) {\n        if (index === 0) {\n          sums[index] = '总计';\n          return;\n        }\n\n        if (column.property == 'price') {\n          var values = data.map(function (item) {\n            return Number(item['price']);\n          });\n\n          if (!values.every(function (value) {\n            return isNaN(value);\n          })) {\n            sums[1] = values.reduce(function (prev, curr) {\n              var value = Number(curr);\n\n              if (!isNaN(value)) {\n                return prev + curr;\n              } else {\n                return prev;\n              }\n            }, 0);\n          } else {\n            sums[index] = '';\n          }\n        } else {\n          sums[index] = '';\n          return;\n        }\n      });\n      return sums;\n    },\n    openDialog: function openDialog(type, row, index) {\n      if (type == 'price') {\n        this.dialogPriceForm.prodId = row.id;\n        this.dialogPriceForm.type = 2;\n        this.dialogPriceForm.index = index;\n      }\n\n      this.dialogOpen[type] = true;\n    },\n    cancelDialog: function cancelDialog(type) {\n      this.dialogOpen[type] = false;\n    },\n    rmRow: function rmRow(index) {\n      this.itemInfo.items.splice(index, 1);\n    },\n    addRow: function addRow(data) {\n      this.itemInfo.items.push(Object.assign.apply(Object, _toConsumableArray(data).concat([{\n        type: 2\n      }])));\n      this.cancelDialog('prod');\n    },\n    addPrice: function addPrice(data) {\n      var _this = this;\n\n      var result = [];\n      this.itemInfo.items.forEach(function (item, index) {\n        if (index == _this.dialogPriceForm.index) {\n          item.price = data.standardPrice;\n          item.currency = data.currency;\n          item.currencyName = data.currencyName;\n        }\n\n        result.push(item);\n      });\n      this.itemInfo.items = result;\n      this.cancelDialog('price');\n    }\n  }\n};",{"version":3,"sources":["itemInfo.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <el-form ref=\"itemForm\" :model=\"itemInfo\" label-width=\"100px\" class=\"demo-form-inline\"  size=\"mini\">\r\n    <el-form-item label=\"产品信息\">\r\n      <el-button type=\"primary\" v-if=\"!isView\" size=\"small\" @click=\"openDialog('prod')\" class=\"add-btn\">添加产品信息</el-button>\r\n        <el-table border size=\"small\"\r\n          show-summary\r\n          :summary-method=\"getSummaries\"\r\n          :span-method=\"arraySpanMethod\"\r\n          :data=\"itemInfo.items\">\r\n          <el-table-column label=\"产品项名称\" prop=\"propName\" width=\"120\"></el-table-column>\r\n          <el-table-column label=\"产品项编码\" prop=\"propCode\" width=\"90\"></el-table-column>\r\n          <el-table-column label=\"所属部门\" prop=\"propDeptName\"></el-table-column>\r\n          <el-table-column label=\"产品类型\" prop=\"cateIdName\"></el-table-column>\r\n          <el-table-column label=\"发布应用\" prop=\"prodIdName\"></el-table-column>\r\n          <el-table-column label=\"发布范围\" prop=\"releaseScopeName\" width=\"90\"></el-table-column>\r\n          <el-table-column label=\"产品来源\" prop=\"itemSourseName\" width=\"90\"></el-table-column>\r\n          <el-table-column label=\"标准价\"  prop=\"price\">\r\n            <template slot=\"header\" slot-scope=\"scope\">\r\n              <span><i class=\"table-tip\">*</i>标准价</span> \r\n            </template>\r\n            <template slot-scope=\"scope\">\r\n              <el-form-item :prop=\"'items.' + scope.$index +'.price'\"\r\n                :rules=\"[{ required: true, message: '请选择', trigger: 'blur' }]\">\r\n              <el-input type=\"number\"\r\n                disabled  size=\"mini\"\r\n              v-model=\"scope.row.price\" \r\n              @click.native=\"openDialog('price', scope.row, scope.$index)\"></el-input>\r\n              </el-form-item>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column label=\"促销价\" prop=\"promotionPrice\">\r\n            <template slot=\"header\" slot-scope=\"scope\">\r\n              <span><i class=\"table-tip\">*</i>促销价</span> \r\n            </template>\r\n            <template slot-scope=\"scope\">\r\n              <el-form-item :prop=\"'items.' + scope.$index +'.promotionPrice'\"\r\n                :rules=\"[ { required: true, message: '请输入', trigger: 'blur' }]\">\r\n                <el-input type=\"number\" v-model=\"scope.row.promotionPrice\"></el-input>\r\n              </el-form-item>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column label=\"币种\" prop=\"currencyName\"></el-table-column>\r\n          <el-table-column v-if=\"!isView\" label=\"操作\" fixed=\"right\" width=\"80\">\r\n            <template slot-scope=\"scope\">\r\n              <el-button icon=\"el-icon-circle-plus-outline\" type=\"text\" size=\"small\" @click=\"rmRow(scope.$index)\">删除</el-button>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n    </el-form-item>\r\n    <itemDialog dialogTitle=\"添加产品\" :dialogForm=\"dialogForm\" :prodDialog=\"dialogOpen.prod\" @result=\"addRow\" @cancel=\"cancelDialog('prod')\"></itemDialog>\r\n    <priceDialog dialogTitle=\"选择价格\" :dialogForm=\"dialogPriceForm\" :dialogOpen=\"dialogOpen.price\" @result=\"addPrice\" @cancel=\"cancelDialog('price')\"></priceDialog>\r\n  </el-form>\r\n</template>\r\n<script>\r\nimport itemDialog from \"./item-dialog\";\r\nimport priceDialog from \"./price-dialog\"\r\nexport default {\r\n  name:'product-info',\r\n  components:{itemDialog, priceDialog},\r\n  props:{\r\n    isView:false,\r\n    itemInfo:{\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      dialogForm:{},\r\n      dialogPriceForm:{\r\n        prodName:'',\r\n        prodType:'',\r\n        prodId:'',\r\n        type:''\r\n      },\r\n      dialogOpen:{\r\n        prod:false,\r\n        price:false\r\n      }\r\n    }\r\n  },\r\n  mounted(){\r\n    this.onLoad()\r\n  },\r\n  methods:{\r\n    onLoad(){\r\n    },\r\n    arraySpanMethod(){\r\n      var that = this;\r\n      setTimeout(function () {\r\n        if (that.$el.querySelector(\".el-table__footer-wrapper\")) {\r\n          var current = that.$el.querySelector(\".el-table__footer-wrapper\")\r\n            .querySelector(\".el-table__footer\");\r\n          var cells = current.rows[0].cells;\r\n          cells[0].colSpan = \"7\";\r\n          cells[1].colSpan = \"4\";\r\n        }\r\n      }, 50);\r\n    },\r\n    getSummaries(param){\r\n      const { columns, data } = param;\r\n      const sums = [];\r\n      columns.forEach((column, index) => {\r\n        if (index === 0) {\r\n          sums[index] = '总计';\r\n          return;\r\n        }\r\n        if(column.property == 'price'){\r\n          const values = data.map(item => Number(item['price']));\r\n          if (!values.every(value => isNaN(value))) {\r\n            sums[1] = values.reduce((prev, curr) => {\r\n              const value = Number(curr);\r\n              if (!isNaN(value)) {\r\n                return prev + curr;\r\n              } else {\r\n                return prev;\r\n              }\r\n            }, 0);\r\n          } else {\r\n            sums[index] = '';\r\n          }\r\n        }else{\r\n          sums[index] = '';\r\n          return;\r\n        }\r\n        \r\n      });\r\n      return sums;\r\n    },\r\n    openDialog(type, row, index){\r\n      if(type == 'price'){\r\n        this.dialogPriceForm.prodId = row.id;\r\n        this.dialogPriceForm.type = 2;\r\n        this.dialogPriceForm.index = index;\r\n      }\r\n      this.dialogOpen[type]=true\r\n    },\r\n    cancelDialog(type){\r\n      this.dialogOpen[type]=false\r\n    },\r\n    rmRow(index){\r\n      this.itemInfo.items.splice(index, 1);\r\n    },\r\n    addRow(data){\r\n      this.itemInfo.items.push(Object.assign(...data,{type:2}));\r\n      this.cancelDialog('prod');\r\n    },\r\n    addPrice(data){\r\n      let result=[];\r\n      this.itemInfo.items.forEach((item,index)=>{\r\n        if(index == this.dialogPriceForm.index){\r\n          item.price= data.standardPrice;\r\n          item.currency= data.currency;\r\n          item.currencyName= data.currencyName;\r\n        }\r\n        result.push(item);\r\n      })\r\n      this.itemInfo.items = result;\r\n      this.cancelDialog('price');\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.add-btn{\r\n  margin-bottom: 1rem;\r\n}\r\n.table-tip{\r\n  color: #F56C6C;\r\n  font-weight: normal;\r\n  vertical-align: middle;\r\n  margin-right: 2px;\r\n  font-size: 14px;\r\n}\r\n.normal-input{\r\n  margin-bottom: 18px;\r\n}\r\n</style>"],"sourceRoot":"src/views/contract/product/group"}]}