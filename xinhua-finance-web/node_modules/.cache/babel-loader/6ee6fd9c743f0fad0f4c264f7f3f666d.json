{"remainingRequest":"F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\node_modules\\babel-loader\\lib\\index.js!F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\src\\views\\contract\\contract\\addContract.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\src\\views\\contract\\contract\\addContract.vue","mtime":1618568524332},{"path":"F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.string.link\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport basicInfo from \"./components/basicInfo\";\nimport productInfo from \"./components/productInfo\";\nimport userAgreementInfo from \"./components/userAgreementInfo\";\nimport authorizationInfo from \"./components/authorizationInfo\";\nimport { saveBasicInfo, saveUserAgreementInfo as _saveUserAgreementInfo } from \"@/api/contract/contract/contract\";\nimport { Message } from 'element-ui';\nexport default {\n  name: \"add-contract\",\n  components: {\n    basicInfo: basicInfo,\n    productInfo: productInfo,\n    userAgreementInfo: userAgreementInfo,\n    authorizationInfo: authorizationInfo\n  },\n  props: {\n    id: '',\n    title: \"新增\",\n    dicDataList: []\n  },\n  data: function data() {\n    return {\n      activeStep: 1,\n      contractInfo: {\n        id: \"\",\n        basicInfo: {\n          conSource: \"\",\n          conNcId: \"\",\n          conNcNo: \"\",\n          conNo: \"\",\n          conName: \"\",\n          conLimit: \"\",\n          custId: \"\",\n          custName: \"\",\n          custContractId: \"\",\n          deptId: \"\",\n          conPartb: \"\",\n          conType: \"\",\n          conState: \"\",\n          signState: \"\",\n          signType: \"\",\n          renewalState: \"\",\n          signDate: \"\",\n          contractTime: \"\",\n          conStartTime: \"\",\n          conEndTime: \"\",\n          conAmount: \"\",\n          conCurrAmount: \"\",\n          conDemand: \"\",\n          isCreated: \"\",\n          fileList: [],\n          //用户协议附件list\n          custContract: [],\n          //合约联系人信息\n          contactsNumber: 0 //可选合约联系人数量\n\n        },\n        productInfo: {},\n        userAgreementInfo: {},\n        authorizationInfo: {}\n      }\n    };\n  },\n  methods: {\n    updateStep: function updateStep(step) {\n      if (step == 5) {\n        this.activeStep = 1;\n        this.$emit(\"addBack\");\n      } else {\n        this.activeStep = step;\n      }\n    },\n    goBackList: function goBackList() {\n      this.$emit(\"addBack\");\n    },\n    //保存基本信息\n    saveBasic: function saveBasic() {\n      var _this = this;\n\n      this.contractInfo.basicInfo.id = this.contractInfo.id; //有可能其他模块先创建数据，已经生成了合约id，但是basicinfo里面id还没有，所以这里要赋值一下\n\n      var basicInfo = this.contractInfo.basicInfo;\n\n      if (basicInfo.contractTime) {\n        basicInfo.conStartTime = basicInfo.contractTime[0] + \" 00:00:00\";\n        basicInfo.conEndTime = basicInfo.contractTime[1] + \" 23:59:59\";\n      }\n\n      var fileList = basicInfo.fileList;\n\n      for (var i = 0; i < fileList.length; i++) {\n        fileList[i].fileUrl = fileList[i].response.data.link;\n        fileList[i].fileName = fileList[i].name;\n        fileList[i].status = null;\n      }\n\n      saveBasicInfo(basicInfo).then(function (res) {\n        _this.contractInfo.id = res.data.data.id;\n        _this.contractInfo.basicInfo.id = res.data.data.id;\n        _this.contractInfo.basicInfo.conNo = res.data.data.conNo;\n        _this.contractInfo.basicInfo.isCreated = res.data.data.isCreated;\n\n        _this.$message.success('保存成功');\n      }, function (error) {\n        _this.$message.error(error);\n      });\n    },\n    saveUserAgreementInfo: function saveUserAgreementInfo(userAgreementInfo) {\n      var vm = this; // 如果未选择数据 则不做处理\n\n      if (userAgreementInfo == null || userAgreementInfo == undefined) return;\n      this.contractInfo.userAgreementInfo = userAgreementInfo;\n      console.log(this.contractInfo.userAgreementInfo);\n      console.log(userAgreementInfo); // 抽取协议id\n\n      var agreementId = [];\n      userAgreementInfo.forEach(function (value, index) {\n        agreementId.push(\"\".concat(value.id));\n      }); // 定义传值对象\n\n      var params = {\n        id: this.contractInfo.id,\n        agreementIdList: agreementId\n      }; // 保存信息\n\n      _saveUserAgreementInfo(params).then(function (rtnData) {\n        vm.contractInfo.id = rtnData.data.data;\n        Message({\n          message: rtnData.data.msg,\n          type: 'success'\n        });\n      });\n    }\n  }\n};",{"version":3,"sources":["addContract.vue"],"names":[],"mappings":"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","sourcesContent":["<!--创建合约-->\r\n<template>\r\n   <basic-container>\r\n        <el-row style=\"margin-bottom: 20px;\">\r\n        <el-col :span=\"24\">\r\n          <el-page-header @back=\"goBackList\" :content=\"title\">\r\n          </el-page-header>\r\n        </el-col>\r\n        </el-row>\r\n       <el-steps :active=\"activeStep\">\r\n            <el-step title=\"基本信息\"></el-step>\r\n            <el-step title=\"产品信息\"></el-step>\r\n            <el-step title=\"用户协议\"></el-step>\r\n            <el-step title=\"用户授权\"></el-step>\r\n        </el-steps>\r\n        <basic-info ref=\"basicInfo\" v-if=\"activeStep==1\" @update=\"updateStep\" :dicDataList=\"dicDataList\" :basicInfo=\"contractInfo.basicInfo\" @saveBasic=\"saveBasic\"></basic-info>\r\n        <product-info ref=\"productInfo\" v-if=\"activeStep==2\" @update=\"updateStep\"></product-info>\r\n        <user-agreement-info  ref=\"userAgreementInfo\" v-if=\"activeStep==3\" @update=\"updateStep\"  @saveUserAgreementInfo=\"saveUserAgreementInfo\" :userAgreementInfo=\"contractInfo.userAgreementInfo\"></user-agreement-info>\r\n        <authorization-info  ref=\"authorizationInfo\" v-if=\"activeStep==4\" @update=\"updateStep\"></authorization-info>\r\n   </basic-container>\r\n</template>\r\n<script>\r\nimport basicInfo from './components/basicInfo';\r\nimport productInfo from './components/productInfo';\r\nimport userAgreementInfo from './components/userAgreementInfo';\r\nimport authorizationInfo from './components/authorizationInfo';\r\nimport {saveBasicInfo, saveUserAgreementInfo} from \"@/api/contract/contract/contract\";\r\nimport {Message} from 'element-ui'\r\nexport default {\r\n    name:\"add-contract\",\r\n    components:{\r\n        basicInfo,\r\n        productInfo,\r\n        userAgreementInfo,\r\n        authorizationInfo\r\n    },\r\n    props:{\r\n      id:'',\r\n      title:\"新增\",\r\n      dicDataList:[]\r\n    },\r\n    data(){\r\n        return{\r\n            activeStep:1,\r\n            contractInfo:{\r\n                id:\"\",\r\n                basicInfo:{\r\n                    conSource:\"\",\r\n                    conNcId:\"\",\r\n                    conNcNo:\"\",\r\n                    conNo:\"\",\r\n                    conName:\"\",\r\n                    conLimit:\"\",\r\n                    custId:\"\",\r\n                    custName:\"\",\r\n                    custContractId:\"\",\r\n                    deptId:\"\",\r\n                    conPartb:\"\",\r\n                    conType:\"\",\r\n                    conState:\"\",\r\n                    signState:\"\",\r\n                    signType:\"\",\r\n                    renewalState:\"\",\r\n                    signDate:\"\",\r\n                    contractTime:\"\",\r\n                    conStartTime:\"\",\r\n                    conEndTime:\"\",\r\n                    conAmount:\"\",\r\n                    conCurrAmount:\"\",\r\n                    conDemand:\"\",\r\n                    isCreated:\"\",\r\n\r\n                    fileList:[],//用户协议附件list\r\n                    custContract:[],//合约联系人信息\r\n                    contactsNumber:0//可选合约联系人数量\r\n                },\r\n                productInfo:{},\r\n                userAgreementInfo:{},\r\n                authorizationInfo:{}\r\n            }\r\n        }\r\n    },\r\n    methods:{\r\n        updateStep(step){\r\n            if(step==5){\r\n                this.activeStep=1;\r\n                this.$emit(\"addBack\");\r\n            }else{\r\n                this.activeStep=step;\r\n            }\r\n        },\r\n        goBackList() {\r\n          this.$emit(\"addBack\");\r\n        },\r\n        //保存基本信息\r\n        saveBasic(){\r\n            this.contractInfo.basicInfo.id = this.contractInfo.id;//有可能其他模块先创建数据，已经生成了合约id，但是basicinfo里面id还没有，所以这里要赋值一下\r\n            var basicInfo = this.contractInfo.basicInfo;\r\n            if(basicInfo.contractTime){\r\n                basicInfo.conStartTime = basicInfo.contractTime[0] + \" 00:00:00\";\r\n                basicInfo.conEndTime = basicInfo.contractTime[1] + \" 23:59:59\";\r\n            }\r\n            var fileList = basicInfo.fileList;\r\n            for(let i =0; i<fileList.length; i++){\r\n                fileList[i].fileUrl = fileList[i].response.data.link;\r\n                fileList[i].fileName = fileList[i].name;\r\n                fileList[i].status = null;\r\n            }\r\n            saveBasicInfo(basicInfo).then(res =>{\r\n                this.contractInfo.id = res.data.data.id;\r\n                this.contractInfo.basicInfo.id = res.data.data.id;\r\n                this.contractInfo.basicInfo.conNo = res.data.data.conNo;\r\n                this.contractInfo.basicInfo.isCreated = res.data.data.isCreated;\r\n                this.$message.success('保存成功');\r\n            } ,error =>{\r\n                this.$message.error(error);\r\n            });\r\n        },\r\n        saveUserAgreementInfo(userAgreementInfo) {\r\n           let vm = this;\r\n            // 如果未选择数据 则不做处理\r\n            if (userAgreementInfo == null || userAgreementInfo == undefined ) return;\r\n            this.contractInfo.userAgreementInfo = userAgreementInfo;\r\n            console.log(this.contractInfo.userAgreementInfo);\r\n            console.log(userAgreementInfo);\r\n            // 抽取协议id\r\n            let agreementId = [];\r\n            userAgreementInfo.forEach(function(value,index){\r\n              agreementId.push(\"\".concat(value.id));\r\n            })\r\n            // 定义传值对象\r\n            let params = {\r\n              id: this.contractInfo.id,\r\n              agreementIdList: agreementId\r\n            }\r\n\r\n            // 保存信息\r\n            saveUserAgreementInfo(params).then(function (rtnData) {\r\n              vm.contractInfo.id = rtnData.data.data;\r\n              Message({\r\n                message: rtnData.data.msg,\r\n                type: 'success'\r\n              })\r\n            });\r\n        }\r\n    }\r\n}\r\n</script>\r\n<style lang=\"scss\">\r\n.el-basic-title{\r\n    font-size: 16px;\r\n    font-weight: 500;\r\n    color: #333;\r\n    padding:1rem 0;\r\n}\r\n.el-product-btn{\r\n   margin: 0 0 1rem 0.5rem;\r\n}\r\n.el-basic-content{\r\n    .el-form--inline .el-form-item,\r\n    .el-select,\r\n    .el-date-editor.el-input,\r\n    .el-range-editor--small.el-input__inner{\r\n        width: 100%;\r\n    }\r\n    .el-form--inline .el-form-item__content{\r\n        width: calc( 100% - 200px );\r\n    }\r\n    .add-contacts{\r\n        margin-bottom: 1rem;\r\n    }\r\n}\r\n .el-step-footer{\r\n    text-align: center;\r\n}\r\n.dialog-footer{\r\n    text-align: center;\r\n}\r\n</style>\r\n"],"sourceRoot":"src/views/contract/contract"}]}