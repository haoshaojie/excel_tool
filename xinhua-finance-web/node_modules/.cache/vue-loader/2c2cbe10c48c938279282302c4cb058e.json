{"remainingRequest":"F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\src\\views\\partner\\orderprofit.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\src\\views\\partner\\orderprofit.vue","mtime":1618367977459},{"path":"F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {getList} from \"@/api/partner/orderprofit\";\n\nexport default {\n  data() {\n    return {\n      tableData: [],\n      dialogVisible: false,\n      searchParam:{\n        queryProfitTime:[ this.$route.query.startProfitTime,this.$route.query.endProfitTime]\n      },\n      form: {},\n      query: {},\n      loading: true,\n      pageTab1: {\n        pageSize: 10,\n        currentPage: 1,\n        total: 0\n      },\n      pageTab2: {\n        pageSize: 10,\n        currentPage: 1,\n        total: 0\n      },\n      partnerId:0,\n      selectionList: [],\n      searchOption:{\n        menuSpan:6,\n        submitBtn:false,\n        column:[\n           {\n            label:'分润时间',\n            prop:'queryProfitTime',\n            type: 'datetimerange',\n            format: \"yyyy-MM-dd HH:mm:ss\",\n            valueFormat: \"yyyy-MM-dd HH:mm:ss\",\n            span: 8\n          }, {\n            label:'产品名称',\n            prop:'prodName',\n            span: 5,\n            showWordLimit:true,\n            maxlength:30\n          }, {\n            label:'产品编码',\n            prop:'prodCode',\n            span: 5,\n            showWordLimit:true,\n            maxlength:30\n          }\n        ]\n      },\n      tabType:{},\n      tabOption:{\n        column: [{\n          icon:'el-icon-tickets',\n          label: '企业客户',\n          prop: 'tab1',\n        }, {\n          icon:'el-icon-tickets',\n          label: '个人用户',\n          prop: 'tab2',\n        }]\n      },\n      optionTab1: {\n        height: 'auto',\n        calcHeight: 210,\n        addBtn:false,\n        addRowBtn:false,\n        editBtn:false,\n        viewBtn:false,\n        delBtn:false,\n        refreshBtn:false,\n        searchBtn:false,\n        searchShowBtn:false,\n        filterBtn:false,\n        searchShow: false,\n        menu:false,\n        searchMenuSpan: 6,\n        tip: false,\n        border: true,\n        index: true,\n        selection: false,\n        column: [\n          {\n            label: \"主键id 雪花算法产生\",\n            prop: \"id\",\n            hide:true\n          },\n          {\n            label: \"合约编码\",\n            prop: \"conCode\"\n          },\n          {\n            label: \"合约名称\",\n            prop: \"conName\"\n          },\n          {\n            label: \"合约表id\",\n            prop: \"conId\",\n            hide:true\n          },\n          {\n            label: \"客户名称\",\n            prop: \"customerName\"\n          },\n          {\n            label: \"产品名称\",\n            prop: \"prodName\",\n          },\n          {\n            label: \"产品编码\",\n            prop: \"prodCode\",\n          },\n          {\n            label: \"合约金额(元)\",\n            prop: \"orderAmount\"\n          },\n          {\n            label: \"分润金额(元)\",\n            prop: \"profitAmount\"\n          },\n          {\n            label: \"分润比例\",\n            prop: \"profitRate\",\n            slot:true\n          },\n          {\n            label: \"分润时间\",\n            prop: \"profitTime\"\n          },\n        ]\n      },\n      optionTab2: {\n        height: 'auto',\n        calcHeight: 210,\n        addBtn:false,\n        addRowBtn:false,\n        editBtn:false,\n        viewBtn:false,\n        delBtn:false,\n        refreshBtn:false,\n        searchBtn:false,\n        searchShowBtn:false,\n        filterBtn:false,\n        searchShow: false,\n        menu:false,\n        searchMenuSpan: 6,\n        tip: false,\n        border: true,\n        index: true,\n        selection: false,\n        column: [\n          {\n            label: \"订单编号\",\n            prop: \"orderCode\"\n          },\n          {\n            label: \"订单来源\",\n            prop: \"prodType\"\n          },\n          {\n            label: \"产品名称\",\n            prop: \"prodName\",\n          },\n          {\n            label: \"产品编码\",\n            prop: \"prodCode\",\n          },\n          {\n            label: \"订单金额(元)\",\n            prop: \"profitAmount\"\n          },\n          {\n            label: \"分润比例\",\n            prop: \"profitRate\"\n          },\n         {\n           label: \"分润金额(元)\",\n           prop: \"profitAmount\"\n         },\n          {\n            label: \"分润时间\",\n            prop: \"profitTime\",\n          }\n        ]\n      },\n      dataTab1: [],  // 客户分润明细\n      dataTab2:[]   // 个人分润明细\n    };\n  },\n  created() {\n     this.tabType = this.tabOption.column[0];\n  },\n  computed: {\n    ids() {\n      let ids = [];\n      this.selectionList.forEach(ele => {\n        ids.push(ele.id);\n      });\n      return ids.join(\",\");\n    }\n  },\n  methods: {\n    // tabs切换\n     handleChange(column) {\n       this.tabType = column;\n       // this.$message.success(JSON.stringify(column));\n     },\n    currentChange1(currentPage){\n      this.pageTab1.currentPage = currentPage;\n    },\n    currentChange2(currentPage){\n      this.pageTab2.currentPage = currentPage;\n    },\n    sizeChange1(pageSize){\n      this.pageTab1.pageSize = pageSize;\n    },\n    sizeChange2(pageSize){\n      this.pageTab2.pageSize = pageSize;\n    },\n    onLoad() {\n      this.loading = true;\n      this.partnerId =  this.$route.query.id;\n      let startProfitTime = this.$route.query.startProfitTime;\n      let endProfitTime = this.$route.query.endProfitTime;\n      this.searchParam.queryPprofitTime=[startProfitTime,endProfitTime];\n\n      this.query.parId = this.partnerId;\n       //加载客户分润明细\n       getList(this.pageTab1.currentPage, this.pageTab1.pageSize, Object.assign({profitType:1}, this.query)).then(res => {\n         const data = res.data.data;\n         this.pageTab1.total = data.total;\n         this.dataTab1 = data.records;\n         this.loading = false;\n       });\n\n       // 加载个人分润明细\n       this.pageTab1.currentPage = 1;\n       getList(this.pageTab2.currentPage, this.pageTab2.pageSize, Object.assign({profitType:2}, this.query)).then(res => {\n         const data = res.data.data;\n         this.pageTab2.total = data.total;\n         this.dataTab2 = data.records;\n         this.loading = false;\n       });\n    },\n    // 搜索\n    doSearch() {\n     // this.$message.success('当前数据'+JSON.stringify(this.searchParam));\n\n      // 查询操作\n      this.query = this.searchParam;\n      if(this.searchParam.queryProfitTime) {\n        this.query.startProfitTime = this.searchParam.queryProfitTime[0];\n        this.query.endProfitTime = this.searchParam.queryProfitTime[1];\n      }\n      this.pageTab1.currentPage = 1;\n      this.pageTab2.currentPage = 1;\n      this.onLoad();\n\n    },\n    emptytChange(){\n      // this.$message.success('清空方法回调');\n    },\n    viewProfitRate(row){ //查看合约分润明细\n      if(row.profitRate) {\n        let rateData = JSON.parse(row.profitRate);\n        this.tableData = rateData;\n      } else{\n        this.tableData = [];\n      }\n      this.dialogVisible = true;\n    }\n  }\n};\n",{"version":3,"sources":["orderprofit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+EA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"orderprofit.vue","sourceRoot":"src/views/partner","sourcesContent":["<template>\r\n <basic-container>\r\n  <avue-form ref=\"form\" v-model=\"searchParam\" :option=\"searchOption\" @reset-change=\"emptytChange\" @submit=\"doSearch\">\r\n    <template slot-scope=\"scope\" slot=\"menuForm\">\r\n        <el-button @click=\"doSearch\" icon=\"el-icon-search\">搜索</el-button>\r\n    </template>\r\n  </avue-form>\r\n\r\n\r\n   <avue-tabs :option=\"tabOption\" @change=\"handleChange\"></avue-tabs>\r\n   <span v-if=\"tabType.prop==='tab1'\">\r\n        <avue-crud :option=\"optionTab1\"\r\n                   :table-loading=\"loading\"\r\n                   :data=\"dataTab1\"\r\n                   :page=\"pageTab1\"\r\n                   v-model=\"form\"\r\n                   ref=\"crud\"\r\n                   @search-change=\"searchChange1\"\r\n                   @search-reset=\"searchReset1\"\r\n                   @selection-change=\"selectionChange1\"\r\n                   @current-change=\"currentChange1\"\r\n                   @size-change=\"sizeChange1\"\r\n                   @on-load=\"onLoad\">\r\n         <template slot=\"profitRate\" slot-scope=\"scope\">\r\n           <a @click=\"viewProfitRate(scope.row)\" style=\"color:#078ecf;\">查看</a>\r\n         </template>\r\n\r\n        </avue-crud>\r\n   </span>\r\n   <span v-else-if=\"tabType.prop==='tab2'\">\r\n     <avue-crud :option=\"optionTab2\"\r\n                :table-loading=\"loading\"\r\n                :data=\"dataTab2\"\r\n                :page=\"pageTab2\"\r\n                v-model=\"form\"\r\n                ref=\"crud\"\r\n                @search-change=\"searchChange2\"\r\n                @search-reset=\"searchReset2\"\r\n                @selection-change=\"selectionChange2\"\r\n                @current-change=\"currentChange2\"\r\n                @size-change=\"sizeChange2\"\r\n                @on-load=\"onLoad\">\r\n     </avue-crud>\r\n   </span>\r\n   <el-dialog\r\n     title=\"分润信息\"\r\n     :visible.sync=\"dialogVisible\"\r\n     width=\"30%\"\r\n     :before-close=\"handleClose\">\r\n\r\n     <el-table\r\n       :data=\"tableData\"\r\n\r\n       style=\"width: 100%\">\r\n       <el-table-column\r\n         prop=\"userRcnt\"\r\n         align=\"center\"\r\n         label=\"用户人数\"\r\n         width=\"180\">\r\n       </el-table-column>\r\n       <el-table-column\r\n         prop=\"profitRate\"\r\n         align=\"center\"\r\n         label=\"分润比例\"\r\n         width=\"180\">\r\n       </el-table-column>\r\n       <el-table-column\r\n         prop=\"profitAmount\"\r\n         align=\"center\"\r\n         label=\"分润金额(元)\">\r\n       </el-table-column>\r\n     </el-table>\r\n\r\n   </el-dialog>\r\n </basic-container>\r\n\r\n</template>\r\n\r\n<script>\r\n  import {getList} from \"@/api/partner/orderprofit\";\r\n\r\n  export default {\r\n    data() {\r\n      return {\r\n        tableData: [],\r\n        dialogVisible: false,\r\n        searchParam:{\r\n          queryProfitTime:[ this.$route.query.startProfitTime,this.$route.query.endProfitTime]\r\n        },\r\n        form: {},\r\n        query: {},\r\n        loading: true,\r\n        pageTab1: {\r\n          pageSize: 10,\r\n          currentPage: 1,\r\n          total: 0\r\n        },\r\n        pageTab2: {\r\n          pageSize: 10,\r\n          currentPage: 1,\r\n          total: 0\r\n        },\r\n        partnerId:0,\r\n        selectionList: [],\r\n        searchOption:{\r\n          menuSpan:6,\r\n          submitBtn:false,\r\n          column:[\r\n             {\r\n              label:'分润时间',\r\n              prop:'queryProfitTime',\r\n              type: 'datetimerange',\r\n              format: \"yyyy-MM-dd HH:mm:ss\",\r\n              valueFormat: \"yyyy-MM-dd HH:mm:ss\",\r\n              span: 8\r\n            }, {\r\n              label:'产品名称',\r\n              prop:'prodName',\r\n              span: 5,\r\n              showWordLimit:true,\r\n              maxlength:30\r\n            }, {\r\n              label:'产品编码',\r\n              prop:'prodCode',\r\n              span: 5,\r\n              showWordLimit:true,\r\n              maxlength:30\r\n            }\r\n          ]\r\n        },\r\n        tabType:{},\r\n        tabOption:{\r\n          column: [{\r\n            icon:'el-icon-tickets',\r\n            label: '企业客户',\r\n            prop: 'tab1',\r\n          }, {\r\n            icon:'el-icon-tickets',\r\n            label: '个人用户',\r\n            prop: 'tab2',\r\n          }]\r\n        },\r\n        optionTab1: {\r\n          height: 'auto',\r\n          calcHeight: 210,\r\n          addBtn:false,\r\n          addRowBtn:false,\r\n          editBtn:false,\r\n          viewBtn:false,\r\n          delBtn:false,\r\n          refreshBtn:false,\r\n          searchBtn:false,\r\n          searchShowBtn:false,\r\n          filterBtn:false,\r\n          searchShow: false,\r\n          menu:false,\r\n          searchMenuSpan: 6,\r\n          tip: false,\r\n          border: true,\r\n          index: true,\r\n          selection: false,\r\n          column: [\r\n            {\r\n              label: \"主键id 雪花算法产生\",\r\n              prop: \"id\",\r\n              hide:true\r\n            },\r\n            {\r\n              label: \"合约编码\",\r\n              prop: \"conCode\"\r\n            },\r\n            {\r\n              label: \"合约名称\",\r\n              prop: \"conName\"\r\n            },\r\n            {\r\n              label: \"合约表id\",\r\n              prop: \"conId\",\r\n              hide:true\r\n            },\r\n            {\r\n              label: \"客户名称\",\r\n              prop: \"customerName\"\r\n            },\r\n            {\r\n              label: \"产品名称\",\r\n              prop: \"prodName\",\r\n            },\r\n            {\r\n              label: \"产品编码\",\r\n              prop: \"prodCode\",\r\n            },\r\n            {\r\n              label: \"合约金额(元)\",\r\n              prop: \"orderAmount\"\r\n            },\r\n            {\r\n              label: \"分润金额(元)\",\r\n              prop: \"profitAmount\"\r\n            },\r\n            {\r\n              label: \"分润比例\",\r\n              prop: \"profitRate\",\r\n              slot:true\r\n            },\r\n            {\r\n              label: \"分润时间\",\r\n              prop: \"profitTime\"\r\n            },\r\n          ]\r\n        },\r\n        optionTab2: {\r\n          height: 'auto',\r\n          calcHeight: 210,\r\n          addBtn:false,\r\n          addRowBtn:false,\r\n          editBtn:false,\r\n          viewBtn:false,\r\n          delBtn:false,\r\n          refreshBtn:false,\r\n          searchBtn:false,\r\n          searchShowBtn:false,\r\n          filterBtn:false,\r\n          searchShow: false,\r\n          menu:false,\r\n          searchMenuSpan: 6,\r\n          tip: false,\r\n          border: true,\r\n          index: true,\r\n          selection: false,\r\n          column: [\r\n            {\r\n              label: \"订单编号\",\r\n              prop: \"orderCode\"\r\n            },\r\n            {\r\n              label: \"订单来源\",\r\n              prop: \"prodType\"\r\n            },\r\n            {\r\n              label: \"产品名称\",\r\n              prop: \"prodName\",\r\n            },\r\n            {\r\n              label: \"产品编码\",\r\n              prop: \"prodCode\",\r\n            },\r\n            {\r\n              label: \"订单金额(元)\",\r\n              prop: \"profitAmount\"\r\n            },\r\n            {\r\n              label: \"分润比例\",\r\n              prop: \"profitRate\"\r\n            },\r\n           {\r\n             label: \"分润金额(元)\",\r\n             prop: \"profitAmount\"\r\n           },\r\n            {\r\n              label: \"分润时间\",\r\n              prop: \"profitTime\",\r\n            }\r\n          ]\r\n        },\r\n        dataTab1: [],  // 客户分润明细\r\n        dataTab2:[]   // 个人分润明细\r\n      };\r\n    },\r\n    created() {\r\n       this.tabType = this.tabOption.column[0];\r\n    },\r\n    computed: {\r\n      ids() {\r\n        let ids = [];\r\n        this.selectionList.forEach(ele => {\r\n          ids.push(ele.id);\r\n        });\r\n        return ids.join(\",\");\r\n      }\r\n    },\r\n    methods: {\r\n      // tabs切换\r\n       handleChange(column) {\r\n         this.tabType = column;\r\n         // this.$message.success(JSON.stringify(column));\r\n       },\r\n      currentChange1(currentPage){\r\n        this.pageTab1.currentPage = currentPage;\r\n      },\r\n      currentChange2(currentPage){\r\n        this.pageTab2.currentPage = currentPage;\r\n      },\r\n      sizeChange1(pageSize){\r\n        this.pageTab1.pageSize = pageSize;\r\n      },\r\n      sizeChange2(pageSize){\r\n        this.pageTab2.pageSize = pageSize;\r\n      },\r\n      onLoad() {\r\n        this.loading = true;\r\n        this.partnerId =  this.$route.query.id;\r\n        let startProfitTime = this.$route.query.startProfitTime;\r\n        let endProfitTime = this.$route.query.endProfitTime;\r\n        this.searchParam.queryPprofitTime=[startProfitTime,endProfitTime];\r\n\r\n        this.query.parId = this.partnerId;\r\n         //加载客户分润明细\r\n         getList(this.pageTab1.currentPage, this.pageTab1.pageSize, Object.assign({profitType:1}, this.query)).then(res => {\r\n           const data = res.data.data;\r\n           this.pageTab1.total = data.total;\r\n           this.dataTab1 = data.records;\r\n           this.loading = false;\r\n         });\r\n\r\n         // 加载个人分润明细\r\n         this.pageTab1.currentPage = 1;\r\n         getList(this.pageTab2.currentPage, this.pageTab2.pageSize, Object.assign({profitType:2}, this.query)).then(res => {\r\n           const data = res.data.data;\r\n           this.pageTab2.total = data.total;\r\n           this.dataTab2 = data.records;\r\n           this.loading = false;\r\n         });\r\n      },\r\n      // 搜索\r\n      doSearch() {\r\n       // this.$message.success('当前数据'+JSON.stringify(this.searchParam));\r\n\r\n        // 查询操作\r\n        this.query = this.searchParam;\r\n        if(this.searchParam.queryProfitTime) {\r\n          this.query.startProfitTime = this.searchParam.queryProfitTime[0];\r\n          this.query.endProfitTime = this.searchParam.queryProfitTime[1];\r\n        }\r\n        this.pageTab1.currentPage = 1;\r\n        this.pageTab2.currentPage = 1;\r\n        this.onLoad();\r\n\r\n      },\r\n      emptytChange(){\r\n        // this.$message.success('清空方法回调');\r\n      },\r\n      viewProfitRate(row){ //查看合约分润明细\r\n        if(row.profitRate) {\r\n          let rateData = JSON.parse(row.profitRate);\r\n          this.tableData = rateData;\r\n        } else{\r\n          this.tableData = [];\r\n        }\r\n        this.dialogVisible = true;\r\n      }\r\n    }\r\n  };\r\n</script>\r\n\r\n<style>\r\n</style>\r\n"]}]}