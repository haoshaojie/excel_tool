{"remainingRequest":"F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\src\\views\\contract\\product\\productItem\\extendInfo.vue?vue&type=style&index=0&id=e6fc43f0&lang=scss&scoped=true&","dependencies":[{"path":"F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\src\\views\\contract\\product\\productItem\\extendInfo.vue","mtime":1618541026429},{"path":"F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\东方通\\source\\b_zwj\\xinhua-finance-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.add-btn{\r\n  margin-bottom: 1rem;\r\n}\r\n",{"version":3,"sources":["extendInfo.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+GA;AACA;AACA","file":"extendInfo.vue","sourceRoot":"src/views/contract/product/productItem","sourcesContent":["<template>\r\n  <el-row>\r\n    <el-col span=\"12\">\r\n      <el-form ref=\"extendForm\" :model=\"extendInfo\" label-width=\"100px\" class=\"demo-form-inline\"  size=\"small\">\r\n        <el-button type=\"primary\" size=\"small\" v-if=\"!isView\" @click=\"openDialog\" class=\"add-btn\">添加扩展属性</el-button>\r\n        <el-form-item v-for=\"(item, i) in extendInfo.itemValues\" :key='i' :label=\"item.propName\" :prop=\"'itemValues.'+i+'.propValue'\"\r\n          :rules=\"item.isRequired==1?[{ required: true, message:`请输入${item.propName}`, trigger: 'blur' }]:''\">\r\n          <el-row v-if=\"item.showType == 1\" style=\"display: flex;\">\r\n            <el-input v-model=\"item.propValue\" :disabled=\"isView\" placeholder=\"请输入\" size=\"small\"></el-input>\r\n            <el-button icon=\"el-icon-remove-outline\" type=\"text\" v-if=\"!isView\" @click=\"extendInfoRm(i)\" style=\"margin-left: 10px; color: #E02020;\">删除</el-button>\r\n          </el-row>\r\n          <el-row v-if=\"item.showType == 2\" style=\"display: flex;\">\r\n            <el-select style=\"width:100%\" :disabled=\"isView\" v-model=\"item.propValue\" placeholder=\"请选择\" size=\"small\">\r\n              <el-option v-for=\"(im,t) in item.options\" :key=\"t\" :label=\"im.propValue\" :value=\"im.propValue\"></el-option>\r\n            </el-select>\r\n            <el-button icon=\"el-icon-remove-outline\" type=\"text\" v-if=\"!isView\" @click=\"extendInfoRm(i)\" style=\"margin-left: 10px; color: #E02020;\">删除</el-button>\r\n          </el-row>\r\n        </el-form-item>\r\n        <extend-pro-dialog \r\n              dialogTitle=\"添加扩展属性\" \r\n              :dialogForm=\"dialogForm\" \r\n              :proDialog=\"openProDialog\" \r\n              @result=\"extendInfoAdd\" \r\n              @cancel=\"cancelDialog\">\r\n        </extend-pro-dialog>\r\n      </el-form>\r\n    </el-col>\r\n  </el-row>\r\n</template>\r\n<script>\r\nimport extendProDialog from \"./extendProDialog\";\r\nimport {itemValueByProdId} from \"@/api/contract/product/productitem\";\r\nimport {getListByCate} from \"@/api/contract/product/property\";\r\nimport bus from '@/assets/js/event-bus';\r\nexport default {\r\n  components:{extendProDialog},\r\n  name:\"extendInfo\",\r\n  props:{\r\n    isView:false,\r\n    extendInfo:{\r\n    }\r\n  },\r\n  data(){\r\n      return {\r\n        dialogForm:{\r\n          propType:2,\r\n          exclude:'',\r\n        },\r\n        cateId:'',\r\n        excludeIds:[],\r\n        openProDialog:false,\r\n      }\r\n  },\r\n  mounted(){\r\n    bus.$on('cateIdBus',data =>{\r\n      this.cateId = data;\r\n      this.initExtendInfo();\r\n    })\r\n  },\r\n  methods:{\r\n    showData(data){\r\n      this.cateId = data.cateId?data.cateId:'';\r\n      itemValueByProdId(data.id).then(res =>{\r\n        let data = res.data.data;\r\n        console.log(\"extend\",data)\r\n        this.extendInfo.itemValues.push(...data);\r\n        data.forEach(item => {\r\n          this.excludeIds.push(item.propId);\r\n        });\r\n        this.dialogForm.exclude = this.excludeIds.join(',');\r\n        })\r\n    },\r\n    initExtendInfo(){\r\n      this.extendInfo.itemValues=[];\r\n      // 查询 当前类型先的属性已经属性待选值\r\n      getListByCate({propType:this.dialogForm.propType,cateId:this.cateId}).then(res => {\r\n        const data = res.data.data;\r\n        this.extendInfoAdd(data)\r\n      });\r\n    },\r\n    cancelDialog(){\r\n      this.openProDialog = false\r\n    },\r\n    openDialog(){\r\n      if(this.cateId ==''){\r\n        this.$message.warning('请先选择产品类型');\r\n      }else{\r\n        this.openProDialog = true\r\n      }\r\n    },\r\n    extendInfoAdd(data) {\r\n      if(data){\r\n        data.forEach(item => {\r\n          this.excludeIds.push(item.id);\r\n          item.propId = item.id;\r\n        });\r\n        this.extendInfo.itemValues.push(...data);\r\n        console.log(123,this.extendInfo.itemValues)\r\n        this.dialogForm.exclude = this.excludeIds.join(',');\r\n      }\r\n      this.openProDialog = false;\r\n    },\r\n    extendInfoRm(index){\r\n      this.extendInfo.itemValues.splice(index, 1);\r\n      this.excludeIds.splice(index, 1);\r\n      this.dialogForm.exclude = this.excludeIds.join(',');\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.add-btn{\r\n  margin-bottom: 1rem;\r\n}\r\n</style>"]}]}